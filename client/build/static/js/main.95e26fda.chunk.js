(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{46:function(e,t,c){},76:function(e,t,c){"use strict";c.r(t);var n=c(1),s=c.n(n),a=c(23),r=c.n(a),o=(c(46),c(8)),i=c.n(o),l=c(14),u=c(2),d=c(16),j=c(5),b=c(6),m=c.n(b),p=c(0);function f(){var e=Object(n.useState)({pseudoSign:"",passwordSign:"",confirmPassword:"",checked:!1}),t=Object(u.a)(e,2),c=t[0],s=t[1],a=function(e){var t=e.target,n=t.value,a=t.name;s(Object(j.a)(Object(j.a)({},c),{},Object(d.a)({},a,n)))},r=Object(n.useRef)(),o=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,s,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=document.querySelector(".pseudo-sign.error"),s=document.querySelector(".password-sign.error"),a=document.querySelector(".confirm-password-sign.error"),r=document.querySelector(".checkbox.error"),n.innerHTML="",s.innerHTML="",a.innerHTML="",r.innerHTML="",c.passwordSign!==c.confirmPassword||!c.checked||c.passwordSign.length<5||c.pseudoSign.length<3?(c.passwordSign!==c.confirmPassword&&(a.innerHTML="Les mots de passe ne correspondent pas"),c.checked||(r.innerHTML="Veuillez valider les conditions d'utilisation"),c.passwordSign.length<5&&(s.innerHTML="5 caract\xe8res minimum"),c.pseudoSign.length<3&&(n.innerHTML="3 caract\xe8res minimum")):m()({method:"post",url:"/users/register",withCredentials:!0,data:{pseudo:c.pseudoSign,password:c.passwordSign}}).then((function(e){e.data.errors?e.data.errors.pseudo&&(n.innerHTML=e.data.errors.pseudo):m()({method:"post",url:"/users/logIn",withCredentials:!0,data:{pseudo:c.pseudoSign,password:c.passwordSign}}),window.location="/accueil"})).catch((function(e){console.log(e)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("form",{onSubmit:o,children:[Object(p.jsx)("p",{children:"Cr\xe9er un compte"}),Object(p.jsx)("input",{type:"text",name:"pseudoSign",placeholder:"Pseudo",value:c.pseudoSign,onChange:a}),Object(p.jsx)("div",{className:"error pseudo-sign"}),Object(p.jsx)("input",{type:"password",name:"passwordSign",id:"password",placeholder:"Mot de passe",value:c.passwordSign,onChange:a}),Object(p.jsx)("div",{className:"error password-sign"}),Object(p.jsx)("input",{type:"password",name:"confirmPassword",id:"confirm-password",placeholder:"Confirmer mot de passe",value:c.confirmPassword,onChange:a}),Object(p.jsx)("div",{className:"error confirm-password-sign"}),Object(p.jsxs)("div",{className:"check",children:[Object(p.jsx)("input",{type:"checkbox",name:"",id:"check",ref:r,onClick:function(){c.checked=!c.checked}}),Object(p.jsx)("label",{htmlFor:"check",children:"J'accepte les "}),Object(p.jsx)("span",{children:"conditions d'utilisation"})]}),Object(p.jsx)("div",{className:"error checkbox"}),Object(p.jsx)("button",{children:"Inscription"})]})}function O(){var e=Object(n.useState)({pseudoConnect:"user-demo",passwordConnect:"111111"}),t=Object(u.a)(e,2),c=t[0],s=t[1],a=function(e){var t=e.target,n=t.value,a=t.name;s(Object(j.a)(Object(j.a)({},c),{},Object(d.a)({},a,n)))},r=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=document.querySelector(".pseudo.error"),s=document.querySelector(".password.error"),m()({method:"post",url:"/users/logIn",withCredentials:!0,data:{pseudo:c.pseudoConnect,password:c.passwordConnect}}).then((function(e){e.data.errors?(console.log(e),n.innerHTML=e.data.errors.includes("Pseudo")?e.data.errors:"",s.innerHTML=e.data.errors.includes("Mot de passe")?e.data.errors:""):window.location="/accueil"})).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("form",{onSubmit:r,children:[Object(p.jsx)("p",{children:"Bienvenue"}),Object(p.jsx)("input",{type:"text",placeholder:"Pseudo",onChange:a,name:"pseudoConnect",defaultValue:"user-demo"}),Object(p.jsx)("div",{className:"error pseudo"}),Object(p.jsx)("input",{type:"password",name:"passwordConnect",id:"password",placeholder:"Mot de passe",onChange:a,defaultValue:"111111"}),Object(p.jsx)("div",{className:"error password"}),Object(p.jsx)("button",{type:"submit",children:"Connexion"})]})}var h="data:image/png;base64,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",x=c.p+"static/media/background.ae94bccc.svg",g=function(){var e=Object(n.useState)({sign:!1,connect:!0}),t=Object(u.a)(e,2),c=t[0],s=t[1],a=function(e){"sign"===e&&s({sign:!0,connect:!1}),"connect"===e&&s({sign:!1,connect:!0})};return Object(p.jsxs)("section",{className:"container-register ",children:[Object(p.jsx)("img",{src:x,alt:"fond d'\xe9cran",className:"background-img"}),Object(p.jsxs)("div",{className:"container",children:[Object(p.jsx)("img",{src:h,alt:"logo",className:"logo"}),Object(p.jsxs)("div",{className:"logs",children:[Object(p.jsxs)("div",{className:"btns",children:[Object(p.jsx)("button",{className:c.connect?"btn-connect active":"btn-connect",onClick:function(){return a("connect")},children:"Se connecter"}),Object(p.jsx)("button",{className:c.sign?"btn-sign active":"btn-sign",onClick:function(){return a("sign")},children:"S'inscrire"})]}),Object(p.jsxs)("div",{className:"forms",children:[c.connect&&Object(p.jsx)(O,{}),c.sign&&Object(p.jsx)(f,{})]})]})]})]})},v=c(20),N=c(37),w=c.n(N),y=c(3);function S(){var e=Object(y.c)((function(e){return e.userReducer})),t=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m()({method:"get",url:"/users/logOut",withCredentials:!0}).then((function(){var e;e="jwt","undefined"!==window&&w.a.remove(e,{expires:1})})).catch((function(e){console.log(e)}));case 2:window.location="/";case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(p.jsx)("nav",{children:Object(p.jsxs)("div",{className:"navigation",children:[Object(p.jsx)("div",{className:"logo",children:Object(p.jsx)("img",{src:h,alt:"logo"})}),Object(p.jsxs)("ul",{children:[Object(p.jsx)("li",{children:Object(p.jsxs)(v.b,{exact:!0,activeClassName:"current",to:"/profil",children:[e.pseudo,Object(p.jsx)("img",{src:e.picture,alt:""})]})}),Object(p.jsx)("li",{className:"middle",children:Object(p.jsx)(v.b,{exact:!0,activeClassName:"current",to:"/accueil","aria-label":"accueil",children:Object(p.jsx)("i",{className:"fas fa-home"})})}),Object(p.jsx)("li",{className:"deconnect",onClick:t,"aria-label":"d\xe9connexion",children:Object(p.jsx)("i",{className:"fas fa-power-off"})})]})]})})}var C="GET_POSTS",k="LIKE_POST",A="UNLIKE_POST",E="UPDATE_POST",T="DELETE_POST",P="EDIT_COMMENT",I="DELETE_COMMENT",D="GET_POST_ERRORS",z=function(e){return function(t){return m.a.get("/posts").then((function(c){var n=c.data.reverse().slice(0,e);t({type:C,payload:n})})).catch((function(e){return console.log(e)}))}},_=function(e){return function(t){return m.a.post("/posts",e).then((function(e){console.log("ok"),""!==e.data.maxSize?t({type:D,payload:e.data.maxSize}):""!==e.data.format?t({type:D,payload:e.data.format}):t({type:D,payload:""})}))}},L=function(e){return void 0===e||null===e||"object"===typeof e&&0===Object.keys(e).length||"string"===typeof e&&0===e.trim().length},R=function(e){var t=Date.parse(e);return new Date(t).toLocaleDateString("fr-FR",{hour:"2-digit",minute:"2-digit",year:"numeric",month:"short",day:"numeric"}).toString()},M=function(e){return new Date(e).toLocaleDateString("fr-FR",{hour:"2-digit",minute:"2-digit",year:"numeric",month:"short",day:"numeric"}).toString()},F="GET_USER",U="UPLOAD_PICTURE",X="UPLOAD_BIO",H="FOLLOW_USER",q="UNFOLLOW_USER",G="GET_USER_ERRORS";function V(e){var t=e.idToFollow,c=e.type,s=Object(y.b)(),a=Object(y.c)((function(e){return e.userReducer})),r=Object(n.useState)(!1),o=Object(u.a)(r,2),i=o[0],l=o[1],d=function(e){e.preventDefault(),s(function(e,t){return function(c){return m.a.patch("/users/follow/".concat(e),{idToFollow:t}).then((function(e){c({type:H,payload:t})})).catch((function(e){console.log(e)}))}}(a._id,t)),l(!0)},j=function(e){var c,n;e.preventDefault(),s((c=a._id,n=t,function(e){return m.a.patch("/users/unfollow/".concat(c),{idToUnfollow:n}).then((function(t){console.log(t),e({type:q,payload:n})})).catch((function(e){console.log(e)}))})),l(!1)};return Object(n.useEffect)((function(){L(a.following)||a.following.includes(t)&&l(!0)}),[t,a.following]),Object(p.jsxs)(p.Fragment,{children:[i&&!L(a)&&Object(p.jsxs)("div",{className:"follow-unfollow",children:["suggestion"===c&&Object(p.jsx)("button",{onClick:j,className:"unfollow","aria-label":"ne plus suivre",children:Object(p.jsx)("i",{className:"fas fa-window-close"})}),"card"===c&&Object(p.jsx)("button",{onClick:j,className:"unfollow-card","aria-label":"ne plus suivre",children:Object(p.jsx)("i",{className:"fas fa-check-circle"})})]}),!i&&!L(a)&&Object(p.jsxs)("div",{className:"follow-unfollow",children:["suggestion"===c&&Object(p.jsx)("button",{onClick:d,className:"follow","aria-label":"suivre",children:Object(p.jsx)("i",{className:"fas fa-user-plus"})}),"card"===c&&Object(p.jsx)("button",{onClick:d,className:"follow-card","aria-label":"suivre",children:Object(p.jsx)("i",{className:"far fa-check-circle"})})]})]})}var Y=function(e){var t=e.user,c=e.toggleUser,n=e.userData;return Object(p.jsx)("div",{className:"friend-profil-container",onClick:function(e){console.log(e.target.className),"friend-profil-container"===e.target.className&&c(!1)},children:Object(p.jsxs)("div",{className:"friend-content",children:[Object(p.jsxs)("div",{className:"user-img-pseudo",children:[Object(p.jsx)("img",{src:t.picture,alt:"",className:"user-img"}),Object(p.jsxs)("h3",{className:"user-pseudo",children:[t.pseudo,n._id!==t._id&&Object(p.jsx)(V,{idToFollow:t._id,type:"card"})]}),Object(p.jsxs)("div",{className:"user-registration",children:["Inscrit depuis le ",R(t.createdAt)]})]}),Object(p.jsx)("p",{className:"user-bio",children:t.bio}),Object(p.jsxs)("div",{className:"user-follows",children:[Object(p.jsxs)("div",{className:"user-followers",children:["Abonn\xe9s ",t.followers.length," "]}),Object(p.jsxs)("div",{className:"user-following",children:["Abonnements ",t.following.length]})]})]})})};function B(e){var t=e.post,c=e.userData,s=Object(n.useState)(!1),a=Object(u.a)(s,2),r=a[0],o=a[1],i=Object(n.useState)(null),l=Object(u.a)(i,2),d=l[0],j=l[1],b=Object(y.b)(),f=function(){var e;b((e=t._id,function(t){return m()({method:"delete",url:"/posts/".concat(e)}).then((function(c){t({type:T,payload:{postId:e}})})).catch((function(e){return console.log(e)}))}))};return Object(p.jsxs)("div",{className:"update-post",children:[Object(p.jsxs)("div",{className:"form-update",children:[!r&&Object(p.jsx)("p",{className:"description",children:t.message}),r&&Object(p.jsxs)("form",{onSubmit:function(){var e,c;d&&(b((e=t._id,c=d,function(t){return m()({method:"put",url:"/posts/".concat(e),data:{message:c}}).then((function(n){t({type:E,payload:{message:c,postId:e}})})).catch((function(e){return console.log(e)}))})),o(!1))},children:[Object(p.jsx)("textarea",{defaultValue:t.message,onChange:function(e){return j(e.target.value)}}),Object(p.jsx)("button",{type:"submit",className:"update-btn","aria-label":"valider",children:Object(p.jsx)("i",{className:"fas fa-check-square"})})]})]}),c._id===t.posterId&&Object(p.jsxs)("div",{className:"btns-edit-delete",children:[Object(p.jsx)("button",{onClick:function(){return o(!r)},className:"edit","aria-label":"\xe9diter",children:Object(p.jsx)("i",{className:"far fa-edit"})}),Object(p.jsx)("button",{onClick:function(){window.confirm("Voulez-vous supprimer cet article ?")&&f()},className:"delete","aria-label":"supprimer",children:Object(p.jsx)("i",{className:"far fa-trash-alt"})})]})]})}var W=Object(n.createContext)();function J(e){var t=e.post,c=Object(n.useState)(!1),s=Object(u.a)(c,2),a=s[0],r=s[1],o=Object(n.useContext)(W),i=Object(y.b)();Object(n.useEffect)((function(){t.likers.includes(o)?r(!0):r(!1)}),[o,t.likers,a]);var l=function(){var e,c;r(!1),i((e=t._id,c=o,function(t){return m()({method:"patch",url:"/posts/unlike-post/".concat(e),data:{id:c}}).then((function(n){t({type:A,payload:{postId:e,userId:c}})})).catch((function(e){return console.log(e)}))}))};return Object(p.jsx)(p.Fragment,{children:a?Object(p.jsx)("button",{onClick:function(){return l()},className:"unlike","aria-label":"je n'aime pas",children:Object(p.jsx)("i",{className:"fas fa-heart"})}):Object(p.jsx)("button",{onClick:function(){var e,c;r(!0),i((e=t._id,c=o,function(t){return m()({method:"patch",url:"/posts/like-post/".concat(e),data:{id:c}}).then((function(n){t({type:k,payload:{postId:e,userId:c}})})).catch((function(e){return console.log(e)}))}))},className:"like","aria-label":"j'aime",children:Object(p.jsx)("i",{className:"far fa-heart"})})})}var Z=function(e){var t=e.comment,c=e.postId,s=Object(n.useState)(!1),a=Object(u.a)(s,2),r=a[0],o=a[1],i=Object(n.useState)(!1),l=Object(u.a)(i,2),d=l[0],j=l[1],b=Object(n.useState)(""),f=Object(u.a)(b,2),O=f[0],h=f[1],x=Object(n.useContext)(W),g=Object(y.b)();Object(n.useEffect)((function(){x===t.commenterId&&o(!0)}),[x,t.commenterId]);var v=function(){g(function(e,t){return function(c){return m()({method:"patch",url:"/posts/delete-comment-post/".concat(e),data:{commentId:t}}).then((function(n){c({type:I,payload:{postId:e,commentId:t}})})).catch((function(e){return console.log(e)}))}}(c,t._id)),j(!1)};return Object(p.jsxs)("div",{className:"edit-delete",children:[r&&!d&&Object(p.jsx)("button",{className:"edit",onClick:function(){return j(!d)},"aria-label":"\xe9diter",children:Object(p.jsx)("i",{className:"fas fa-pen"})}),r&&d&&Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),O&&(g(function(e,t,c){return function(n){return m()({method:"patch",url:"/posts/edit-comment-post/".concat(e),data:{commentId:t,text:c}}).then((function(s){n({type:P,payload:{postId:e,commentId:t,text:c}})})).catch((function(e){return console.log(e)}))}}(c,t._id,O)),h("")),j(!1)},className:"form-edit",children:[Object(p.jsx)("textarea",{name:"text",defaultValue:t.text,onChange:function(e){return h(e.target.value)}}),Object(p.jsx)("button",{type:"submit",className:"btn-submit","aria-label":"valider",children:Object(p.jsx)("i",{className:"fas fa-check"})}),Object(p.jsx)("button",{onClick:function(){window.confirm("Voulez-vous supprimer cet article ?")&&v()},className:"btn-delete","aria-label":"supprimer",children:Object(p.jsx)("i",{className:"fas fa-trash-alt"})})]})]})};function Q(e){var t=e.post,c=e.userData,s=e.usersData,a=Object(n.useState)(!1),r=Object(u.a)(a,2),o=r[0],i=r[1];return Object(p.jsxs)("div",{className:"container-comments",children:[Object(p.jsxs)("div",{className:"opinions",children:[Object(p.jsxs)("div",{className:"likes",children:[Object(p.jsx)(J,{post:t}),Object(p.jsx)("button",{children:t.likers.length})]}),Object(p.jsxs)("button",{onClick:function(){return i(!o)},className:"toggle-comment",children:[t.comments.length," commentaires"," ",Object(p.jsx)("i",{className:"fas fa-comment-alt"})]})]}),o&&t.comments.map((function(e){return Object(p.jsxs)("div",{className:e.commenterId===c._id?"text-comment my-comment":"text-comment",children:[Object(p.jsxs)("div",{className:"commenters",children:[Object(p.jsx)("img",{src:!L(s[0])&&s.map((function(t){return t._id===e.commenterId?t.picture:null})).join(""),alt:"utilisateur"}),Object(p.jsx)("span",{className:"commenter-pseudo",children:e.commenterPseudo})]}),Object(p.jsxs)("div",{className:"commenter-text",children:[e.text,Object(p.jsx)(Z,{comment:e,postId:t._id})]}),Object(p.jsx)("div",{className:"comment-date",children:M(e.timestamp)})]},e._id)}))]})}var K=function(e){var t=e.post,c=e.userData,s=Object(y.b)(),a=Object(n.useState)(""),r=Object(u.a)(a,2),o=r[0],i=r[1];return Object(p.jsxs)("form",{className:"message-comment",onSubmit:function(e){e.preventDefault(),o&&s(function(e,t,c,n){return function(s){return m()({method:"patch",url:"/posts/comment-post/".concat(e),data:{commenterId:t,text:c,commenterPseudo:n}}).then((function(t){s({type:"ADD_COMMENT",payload:{postId:e}})})).catch((function(e){return console.log(e)}))}}(t._id,c._id,o,c.pseudo)).then((function(){return s(z())})).then((function(){return i("")}))},children:[Object(p.jsx)("input",{type:"text",placeholder:"Commenter la publication ...",value:o,onChange:function(e){return i(e.target.value)}}),Object(p.jsx)("button",{type:"submit","aria-label":"envoi commentaire",children:Object(p.jsx)("i",{className:"fas fa-paper-plane"})})]})};function $(){var e=Object(n.useState)(!0),t=Object(u.a)(e,2),c=t[0],s=t[1],a=Object(n.useState)(!0),r=Object(u.a)(a,2),o=r[0],i=r[1],l=Object(n.useState)(!1),d=Object(u.a)(l,2),j=d[0],b=d[1],m=Object(n.useState)({}),f=Object(u.a)(m,2),O=f[0],h=f[1],x=Object(y.c)((function(e){return e.postsReducer})),g=Object(y.c)((function(e){return e.usersReducer})),v=Object(y.c)((function(e){return e.userReducer})),N=Object(n.useState)(5),w=Object(u.a)(N,2),S=w[0],C=w[1],k=Object(y.b)();Object(n.useEffect)((function(){!L(g[0])&&s(!1)}),[g]);var A=function(){window.innerHeight+document.documentElement.scrollTop+1>document.scrollingElement.scrollHeight&&i(!0)};Object(n.useEffect)((function(){return o&&(k(z(S)),i(!1),C(S+5)),window.addEventListener("scroll",A),function(){window.removeEventListener("scroll",A)}}),[k]);return Object(p.jsxs)("section",{className:"content",children:[j&&Object(p.jsx)(Y,{user:O,toggleUser:b,userData:v}),!L(x[0])&&x.map((function(e){return Object(p.jsx)("article",{children:c?Object(p.jsxs)("div",{className:"loadings",children:[Object(p.jsxs)("div",{className:"user-loading",children:[Object(p.jsx)("div",{className:"user-picture-loading loading"}),Object(p.jsx)("div",{className:"user-name-loading  loading"}),Object(p.jsx)("div",{className:"date-loading  loading"})]}),Object(p.jsx)("div",{className:"description-loading  loading"}),Object(p.jsx)("div",{className:"media-loading loading",children:" "}),Object(p.jsx)("div",{className:"message-loading  loading",children:" "})]}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"user-info",children:[Object(p.jsxs)("div",{className:"show-user",children:[Object(p.jsx)("div",{className:"img-user",children:Object(p.jsx)("img",{src:!L(g[0])&&g.map((function(t){if(t._id===e.posterId)return t.picture})).join(""),alt:"utilisateur"})}),Object(p.jsx)("h3",{className:"user-name",children:!L(g[0])&&g.map((function(t){if(t._id===e.posterId)return Object(p.jsxs)("button",{onClick:function(){return e=t._id,void g.map((function(t){if(t._id===e)return h(t);b(!0)}));var e},children:[" ",t.pseudo]},t._id)}))}),e.posterId!==v._id&&Object(p.jsx)(V,{idToFollow:e.posterId,type:"card"})]}),Object(p.jsx)("span",{children:R(e.createdAt)})]}),Object(p.jsx)(B,{post:e,userData:v}),Object(p.jsxs)("div",{className:"media",children:[e.picture&&Object(p.jsx)("img",{src:"".concat(e.picture),alt:"publication"}),e.video&&Object(p.jsx)("iframe",{src:e.video,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",title:"vid\xe9o publication ".concat(e.message)})]}),Object(p.jsx)(Q,{post:e,userData:v,usersData:g}),Object(p.jsx)(K,{post:e,userData:v})]})},e._id)}))]})}function ee(){var e=Object(y.b)(),t=Object(n.useState)(""),c=Object(u.a)(t,2),s=c[0],a=c[1],r=Object(n.useState)(null),o=Object(u.a)(r,2),d=o[0],j=o[1],b=Object(n.useState)(""),m=Object(u.a)(b,2),f=m[0],O=m[1],h=Object(n.useState)(),x=Object(u.a)(h,2),g=x[0],v=x[1],N=Object(y.c)((function(e){return e.userReducer})),w=Object(y.c)((function(e){return e.errorReducer})),S=function(){var t=Object(l.a)(i.a.mark((function t(c){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c.preventDefault(),!(s||d||f)){t.next=14;break}return(n=new FormData).append("posterId",N._id),n.append("message",s),g&&n.append("file",g),n.append("video",f),console.log(n),t.next=10,e(_(n));case 10:e(z()),C(),t.next=15;break;case 14:alert("Veuillez entrer un message");case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),C=function(){j(""),a(""),O(""),v("")};return Object(n.useEffect)((function(){!function(){for(var e=f.split(" "),t=0;t<e.length;t++)if(e[t].includes("https://www.yout")||e[t].includes("https://yout")){var c=e[t].replace("watch?v=","embed/");O(c.split("&")[0]),j("")}}()}),[N,f]),Object(p.jsxs)("form",{className:"form-publication",children:[Object(p.jsx)("legend",{children:"Nouvelle publication"}),Object(p.jsx)("input",{type:"text",id:"message",value:s,onChange:function(e){return function(e){a(e)}(e.target.value)},placeholder:"Description..."}),Object(p.jsxs)("div",{className:"medias",children:[L(f)&&Object(p.jsxs)("div",{className:"picture",children:[Object(p.jsx)("span",{children:Object(p.jsx)("i",{className:"fas fa-camera","aria-label":"image"})}),Object(p.jsx)("label",{htmlFor:"file",className:"media-label",children:"Choisissez une image"}),Object(p.jsx)("input",{type:"file",name:"file",id:"file",accept:".jpg, .jpeg, .png",onChange:function(e){return function(e){j(URL.createObjectURL(e.target.files[0])),v(e.target.files[0]),O("")}(e)}})]}),L(d)&&L(f)&&Object(p.jsx)("div",{className:"space"}),L(d)&&Object(p.jsxs)("div",{className:"video",children:[Object(p.jsx)("span",{children:Object(p.jsx)("i",{className:"fas fa-video","aria-label":"vid\xe9o"})}),Object(p.jsx)("input",{type:"text",id:"url",onChange:function(e){return O(e.target.value)},value:f,placeholder:"URL vid\xe9o youtube"})]})]}),(f||s||g||d)&&Object(p.jsxs)("div",{className:"render-post",children:[Object(p.jsxs)("div",{className:"user",children:[Object(p.jsx)("img",{src:N.picture,alt:"utilisateur",className:"render-user-img"}),Object(p.jsx)("h3",{className:"render-post-pseudo",children:N.pseudo})]}),Object(p.jsx)("p",{className:"message-post",children:s}),d&&Object(p.jsx)("img",{src:d,alt:"publication",className:"render-post-media picture-post"}),f&&Object(p.jsx)("iframe",{src:f,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",title:"vid\xe9o publication",className:"render-post-media video-post"})]}),(f||s||g||d)&&Object(p.jsxs)("div",{className:"btns-post",children:[Object(p.jsxs)("button",{className:"cancel-post",onClick:C,children:["Annuler ",Object(p.jsx)("i",{className:"fas fa-ban"})]}),Object(p.jsxs)("button",{className:"send-post",onClick:S,children:["Publier ",Object(p.jsx)("i",{className:"fas fa-check"})]})]}),!L(w)&&Object(p.jsx)("p",{className:"errors",children:w.postsErrors})]})}var te=function(){var e=Object(y.c)((function(e){return e.userReducer})),t=Object(y.c)((function(e){return e.usersReducer})),c=Object(n.useState)(1),s=Object(u.a)(c,2),a=s[0],r=s[1],o=Object(n.useState)(5),i=Object(u.a)(o,2),l=i[0],d=i[1],j=Object(n.useState)(850),b=Object(u.a)(j,2),m=b[0],f=b[1],O=Object(n.useState)([]),h=Object(u.a)(O,2),x=h[0],g=h[1],v=Object(n.useState)(),N=Object(u.a)(v,2),w=N[0],S=N[1],C=Object(n.useState)(!1),k=Object(u.a)(C,2),A=k[0],E=k[1],T=Object(n.useState)({}),P=Object(u.a)(T,2),I=P[0],D=P[1],z=x.length,_=Math.ceil(z/l),R=document.querySelector(".friend-list");Object(n.useEffect)((function(){window.addEventListener("load",(function(){var e=window.innerWidth;S(e),e>1e3&&(d(5),f(850)),e<1e3&&e>650&&(d(4),f(480)),e<650&&(f(240),d(3))})),window.addEventListener("resize",(function(){var e=window.innerWidth;S(e),e>1e3&&(d(5),f(850)),e<1e3&&e>650&&(d(4),f(480)),e<650&&(f(240),d(3))}))}),[w,x,l]);var M=function(e){if("next"===e){if(a>=_)return;R.style.transform="translateX(-".concat(m*a,"px)"),r(a+1)}"prev"===e&&(r(1),R.style.transform="translateX(0)")};Object(n.useEffect)((function(){L(t[0])||L(e._id)||function(){var c=[];t.map((function(t){if(t._id!==e._id&&!t.followers.includes(e._id))return c.push(t._id)})),c.sort((function(){return.5-Math.random()})),g(c)}()}),[e,t]);return Object(p.jsxs)("div",{className:x<=0?"container-friend none":"container-friend",children:[A&&Object(p.jsx)(Y,{user:I,toggleUser:E,userData:e}),Object(p.jsx)("h4",{children:"Vous connaissez peut-\xeatre"}),z&&z>6&&Object(p.jsx)("button",{className:"before-btn",onClick:function(){return M("prev")},"aria-label":"boutton gauche",children:Object(p.jsx)("i",{className:"fas fa-caret-square-left"})}),Object(p.jsx)("div",{className:"friends",children:Object(p.jsx)("ul",{className:"friend-list",children:x&&x.map((function(e){for(var c=0;c<t.length;c++)if(t[c]._id===e)return Object(p.jsxs)("li",{children:[Object(p.jsxs)("button",{onClick:function(){return c=e,console.log(c),void t.map((function(e){if(e._id===c)return D(e);E(!0)}));var c},children:[Object(p.jsx)("img",{src:t[c].picture,alt:"utilisateur"}),Object(p.jsx)("span",{children:t[c].pseudo})]}),Object(p.jsx)(V,{idToFollow:t[c]._id,type:"suggestion"})]},e)}))})}),z&&z>6&&Object(p.jsx)("button",{className:"after-btn",onClick:function(){return M("next")},"aria-label":"boutton droit",children:Object(p.jsx)("i",{className:"fas fa-caret-square-right"})})]})};function ce(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(S,{}),Object(p.jsxs)("main",{className:"home-container container",children:[Object(p.jsx)(ee,{}),Object(p.jsx)(te,{}),Object(p.jsx)($,{})]})]})}var ne=c(7);function se(e){var t=e.userData,c=Object(n.useState)(),s=Object(u.a)(c,2),a=s[0],r=s[1],o=Object(n.useState)(!1),i=Object(u.a)(o,2),l=i[0],d=i[1],j=Object(y.b)();return Object(p.jsxs)("form",{className:"upload-picture",onSubmit:function(e){e.preventDefault();var c=new FormData;c.append("name",t.pseudo),c.append("userId",t._id),c.append("file",a),j(function(e,t){return function(t){return m.a.post("/users/upload",e).then((function(e){console.log(e.data),e.data.errors?(console.log(e.data.errors),""!==e.data.erros.maxSize?t({type:G,payload:e.data.errors.maxSize}):""!==e.data.errors.format&&t({type:G,payload:e.data.errors.format})):(t({type:G,payload:""}),console.log(e),t({type:U,payload:e.data.picture}))})).catch((function(e){return console.log(e)}))}}(c,t._id)),d(!1)},children:[l?Object(p.jsx)("button",{type:"submit",className:"change-img","aria-label":"envoyer",children:Object(p.jsx)("i",{className:"fas fa-check"})}):Object(p.jsx)("label",{htmlFor:"file",className:"change-img","aria-label":"image",children:Object(p.jsx)("i",{className:"far fa-image"})}),Object(p.jsx)("input",{type:"file",name:"file",id:"file",accept:".jpg, .jpeg, .png",onChange:function(e){return function(e){r(e),d(!0)}(e.target.files[0])}})]})}function ae(){var e=Object(y.b)(),t=Object(y.c)((function(e){return e.userReducer})),c=Object(y.c)((function(e){return e.usersReducer})),s=Object(y.c)((function(e){return e.postsReducer})),a=Object(y.c)((function(e){return e.errorReducer}));Object(n.useEffect)((function(){e(z())}),[e]);var r=Object(n.useState)(!1),o=Object(u.a)(r,2),i=o[0],l=o[1],d=Object(n.useState)(t.bio),j=Object(u.a)(d,2),b=j[0],f=j[1],O=function(){l(!i)},h=Object(n.useState)(!1),x=Object(u.a)(h,2),g=x[0],v=x[1],N=Object(n.useState)(!1),w=Object(u.a)(N,2),C=w[0],k=w[1],A=function(e){"followers"===e&&v(!g),"following"===e&&k(!C)},E=function(e){"overlay"===e.target.className&&(v(!1),k(!1))};return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(S,{}),Object(p.jsxs)("main",{className:"profil-container container",children:[Object(p.jsxs)("section",{className:"user",children:[Object(p.jsxs)("div",{className:"user-profil",children:[Object(p.jsx)("img",{src:t.picture,alt:"utilisateur",loading:"lazy"}),Object(p.jsx)(se,{userData:t})]}),!L(a)&&Object(p.jsx)("p",{className:"errors",children:a.usersErrors}),Object(p.jsxs)("div",{className:"profil-bottom",children:[Object(p.jsxs)("form",{className:"user-bio",onSubmit:function(c){c.preventDefault(),O(),e(function(e,t){return function(c){return m.a.put("/users/bio/".concat(t),{bio:e}).then((function(t){c({type:X,payload:e})})).catch((function(e){return console.log(e)}))}}(b,t._id))},children:[Object(p.jsx)("label",{htmlFor:"bio",onClick:O,children:"biographie :"}),i?Object(p.jsx)("textarea",{name:"bio",id:"bio",defaultValue:t.bio,onChange:function(e){f(e.target.value)}}):Object(p.jsx)("p",{onClick:O,children:t.bio}),Object(p.jsx)("button",{type:"submit",className:"update-bio","aria-label":"\xe9diter / valider",children:i?Object(p.jsx)("i",{className:"fas fa-check"}):Object(p.jsx)("i",{className:"fas fa-pencil-alt"})})]}),Object(p.jsxs)("div",{className:"follows",children:[Object(p.jsxs)("div",{className:"followers",onClick:function(){return A("followers")},children:["Abonn\xe9s : ",t.followers&&t.followers.length]}),Object(p.jsxs)("div",{className:"following",onClick:function(){return A("following")},children:["Abonnements : ",t.following&&t.following.length]})]})]})]}),g&&Object(p.jsx)("div",{className:"overlay",onClick:function(e){return E(e)},children:Object(p.jsx)("ul",{className:"follows-popup",children:!L(c)&&c.map((function(e){for(var c=0;c<t.followers.length;c++)if(e._id===t.followers[c])return Object(p.jsxs)("li",{children:[Object(p.jsxs)("div",{className:"users",children:[Object(p.jsx)("img",{src:e.picture,alt:"utilisateur abonn\xe9",loading:"lazy"}),Object(p.jsx)("h4",{children:e.pseudo})]}),Object(p.jsx)(V,{idToFollow:e._id,type:"suggestion"})]},e._id)}))})}),C&&Object(p.jsx)("div",{className:"overlay",onClick:function(e){return E(e)},children:Object(p.jsx)("ul",{className:"follows-popup",children:t.following&&c.map((function(e){for(var c=0;c<t.following.length;c++)if(e._id===t.following[c])return Object(p.jsxs)("li",{children:[Object(p.jsxs)("div",{className:"users",children:[Object(p.jsx)("img",{src:e.picture,alt:"utilisateur abonn\xe9",loading:"lazy"}),Object(p.jsx)("h4",{children:e.pseudo})]}),Object(p.jsx)(V,{idToFollow:e._id,type:"suggestion"})]},e._id)}))})}),Object(p.jsxs)("section",{className:"content",children:[Object(p.jsxs)("div",{className:"name-date",children:[Object(p.jsx)("h2",{children:t.pseudo}),Object(p.jsxs)("span",{children:["Inscrit depuis le ",R(t.createdAt)]})]}),Object(p.jsx)("ul",{className:"container-publication",children:!L(s)&&s.map((function(e){if(e.posterId===t._id)return Object(p.jsxs)("li",{className:"post-card",children:[Object(p.jsx)("div",{className:"top-card",children:Object(p.jsx)(B,{post:e,userData:t})}),e.picture&&Object(p.jsx)("img",{src:e.picture,alt:"publication",loading:"lazy"}),e.video&&Object(p.jsx)("iframe",{src:e.video,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",title:"vid\xe9o publication ".concat(e.message)}),Object(p.jsx)("ul",{children:e.comments[0]&&e.comments.map((function(e){return Object(p.jsxs)("li",{className:"commenters",children:[Object(p.jsx)("p",{className:"commenter-pseudo",children:e.commenterPseudo}),Object(p.jsxs)("div",{className:"comment-time",children:[Object(p.jsx)("p",{className:"commenter-text",children:e.text}),Object(p.jsx)("span",{className:"timestamp",children:M(e.timestamp)})]})]},e._id)}))}),Object(p.jsxs)("div",{className:"opinions",children:[Object(p.jsxs)("div",{className:"likes","aria-label":"likes",children:[Object(p.jsx)("i",{className:"fas fa-heart"})," ",e.likers.length]}),Object(p.jsxs)("div",{className:"comments","aria-label":"commentaires",children:[e.comments.length," ",Object(p.jsx)("i",{className:"fas fa-comment-alt"})]})]})]},e._id)}))})]})]})]})}var re=function(){var e=Object(n.useState)(null),t=Object(u.a)(e,2),c=t[0],s=t[1],a=Object(y.b)();return Object(n.useEffect)((function(){(function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m()({method:"get",url:"/jwtid",withCredentials:!0}).then((function(e){s(e.data)})).catch((function(e){console.log("No token App")}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),c&&a(function(e){return function(t){return m.a.get("/users/user/".concat(e)).then((function(e){t({type:F,payload:e.data})})).catch((function(e){return console.log(e)}))}}(c))}),[c,a]),Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(W.Provider,{value:c,children:Object(p.jsx)(v.a,{children:Object(p.jsxs)(ne.c,{children:[Object(p.jsx)(ne.a,{path:"/",exact:!0,component:g}),Object(p.jsx)(ne.a,{path:"/accueil",exact:!0,component:ce}),Object(p.jsx)(ne.a,{path:"/profil",exact:!0,component:ae})]})})})})},oe=c(17),ie=c(41),le=c(25),ue={_id:"",pseudo:"",picture:"",followers:[],following:[],likes:[],createdAt:"",bio:""};var de="GET_USERS",je={_id:"",pseudo:"",picture:"",followers:[],following:[],likes:[],createdAt:"",bio:""};var be={};var me={postsErrors:[],usersErrors:[]};var pe=Object(oe.combineReducers)({userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F:return t.payload;case U:return Object(j.a)(Object(j.a)({},e),{},{picture:t.payload});case X:return Object(j.a)(Object(j.a)({},e),{},{bio:t.payload});case H:return Object(j.a)(Object(j.a)({},e),{},{following:[].concat(Object(le.a)(e.following),[t.payload])});case q:return Object(j.a)(Object(j.a)({},e),{},{following:e.following.filter((function(e){return e!==t.payload}))});default:return e}},usersReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case de:return t.payload;default:return e}},postsReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:return t.payload;case k:return e.map((function(e){return e._id===t.payload.postId?Object(j.a)(Object(j.a)({},e),{},{likers:[t.payload.userId].concat(Object(le.a)(e.likers))}):e}));case A:return e.map((function(e){return e._id===t.payload.postId?Object(j.a)(Object(j.a)({},e),{},{likers:e.likers.filter((function(e){return e!==t.payload.userId}))}):e}));case E:return e.map((function(e){return e._id===t.payload.postId?Object(j.a)(Object(j.a)({},e),{},{message:t.payload.message}):e}));case T:return e.filter((function(e){return e._id!==t.payload.postId}));case P:return e.map((function(e){return e._id===t.payload.postId?Object(j.a)(Object(j.a)({},e),{},{comments:e.comments.map((function(e){return e._id===t.payload.commentId?Object(j.a)(Object(j.a)({},e),{},{text:t.payload.text}):e}))}):e}));case I:return e.map((function(e){return e._id===t.payload.postId?Object(j.a)(Object(j.a)({},e),{},{comments:e.comments.filter((function(e){return e._id!==t.payload.commentId}))}):e}));default:return e}},errorReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return{postsErrors:t.payload,usersErrors:[]};case G:return{usersErrors:t.payload,postsErrors:[]};default:return e}}}),fe=c(40),Oe=Object(oe.createStore)(pe,Object(fe.composeWithDevTools)(Object(oe.applyMiddleware)(ie.a)));Oe.dispatch((function(e){return m.a.get("/users/allUsers").then((function(t){e({type:de,payload:t.data})})).catch((function(e){return console.log(e)}))})),r.a.render(Object(p.jsx)(s.a.StrictMode,{children:Object(p.jsx)(y.a,{store:Oe,children:Object(p.jsx)(re,{})})}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.95e26fda.chunk.js.map